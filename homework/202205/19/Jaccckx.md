总结STL内存管理原理 

1. 使用allocator向内存池请求size大小的内存空间，如果需要请求的内存大小 大于128 B，直接使用malloc() 

2. 如果需要的内存大小 小于等于128 B，allocator::allocate()根据size找到最适合的自由链表

 ①如果链表不为空，返回第一个node，链表头改为第二个node 

②如果链表为空，使用blockAlloc，请求分配内存 

③如果内存池中有一个大于一个node的空间，分配尽可能多的node（但最多20个），将一个node返回，其他的node添加到链表中。 

④如果内存池只有一个node的空间，直接返回给用户 

⑤若连一个node都没有，再次向操作系统请求分配内存 a.分配成功，再次进行(2的②) 



b.分配失败，循环各个自由链表，寻找空间 

①找到空间，再次进行(2的②) 

②找不到空间，抛出异常 



3. 用户调用allcator::deallocate()释放内存空间，如果要求释放的内存空间大于 128 B，直接调用free()

4. 否则按照其大小找到适合的自由链表，将其插入。
