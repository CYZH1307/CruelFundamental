## 什么是lamport logical clock?

分布式系统解决了传统单体架构的单点问题和性能容量问题，另一方面也带来了很多的问题，其中一个问题就是多节点的时间同步问题：不同机器上的物理时钟难以同步，导致无法区分在分布式系统中多个节点的事件时序。

分布式系统中按是否存在节点交互可分为三类事件，一类发生于节点内部，二是发送事件，三是接收事件。注意：以下文章中提及的时间戳如无特别说明，都指的是Lamport 逻辑时钟的时间戳，不是物理时钟的时间戳

Lamport 逻辑时钟：

对于任意事件a, b：如果a→b（→表示a先于b发生），那么C(a)<C(b), 反之不然, 因为有可能是并发事件
C1.如果a和b都是进程Pi里的事件，并且a在b之前，那么Ci(a)<Ci(b)
C2.如果a是进程Pi里关于某消息的发送事件，b是另一进程Pj里关于该消息的接收事件，那么Ci(a)<Cj(b)

1. 每个事件对应一个Lamport时间戳，初始值为0
2. 如果事件在节点内发生，本地进程中的时间戳加1
3. 如果事件属于发送事件，本地进程中的时间戳加1并在消息中带上该时间戳
4. 如果事件属于接收事件，本地进程中的时间戳 = Max(本地时间戳，消息中的时间戳) + 1