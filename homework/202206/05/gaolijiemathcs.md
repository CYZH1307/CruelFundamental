### 讲讲分页、分段机制

分页和分段都是内存管理的机制（虚拟内存）

MMU将虚拟地址转化为物理地址

#### 分页机制

1、分页的内存地址转换：

- 虚拟内存地址，切分为页号和偏移量。
- 页号去页表找对应的物理页号。
- 物理页号拼接偏移量得到物理内存地址。

2、为了防止页表占用过多内存使用多级页表。

3、为了增加页表访问速度，在CPU当中加入了TLB来加速，页表的查找，将常访问的页表项存储到这个硬件当中。类似Cache。



#### 分段机制

1、分段的内存地址转换：

- 虚拟地址，拆分为段选择子与段内偏移。
- 段选择子中有段号，去段表中查找【段基地址+段界限+特级权限】。
- 按照基地址和段内偏移，基地址加上段内偏移量得到物理内存地址得到物理地址，这里会检查段内偏移是否合法。。

2、分段缺点：内存碎片+内存交换效率低。

- 内存碎片：外部碎片，分段之间有不连续的物理块不好利用。内部碎片，段内内存无法都被使用内存浪费。
- 内存交换效率低：为了解决外部碎片，使用内存交换，将空缺的外部碎片，整合为连续的，因此需要通过内存交换的方式，Linux有swap分区。这个过程有性能瓶颈。因为硬盘访问速度慢，机器会卡顿。

