# 乐观锁与悲观锁

#### 	1.锁的定义

​			悲观锁即常见的将某个线程锁住，只能单独该线程的代码，直至任务完成，而不让其他线程操控。乐观锁是指该线程“乐观”的认为共享变量不会为其他变量所修改，故只是在任务开始前，检测锁是否为其他线程所修改，如果修改，则重复执行。

#### 	2.锁的选择

​			悲观锁消耗大量资源，适合并发量不高的系统，反之选择乐观锁

#### 	3.悲观锁的实现

#####  		CAS机制（Compare & Set / Compare & Swap）：V(内存值)A（预测值）B（新值）

##### 		CAS是原子操作，简要操作为

1. 比较A与V值，
2. 如果值相等，将V改为新值
3. 返回操作是否成功，不成功重复循环



##### 	 A.**用CAS实现的入队操作** - EnQueue() - 会导致其他线程阻塞。

##### 	 B.**改良版的EnQueue()** - 更新尾指针，但是可能会浪费时间。 应该是A 函数 与 B 函数采取合理的比例。

#####     C. CAS的ABA问题(简而言之，即共享变量值没变，但是版本变了，基于严谨性，应该关注版本号)
