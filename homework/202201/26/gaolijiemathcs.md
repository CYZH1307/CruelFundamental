# 20220126 什么是三级封锁协议？

1、两种锁：

（1）共享锁 S锁(shared)：事务可读不可写。事务对数据A上了S锁，那么不允许其他事务加X锁，但可以添加S锁。

（2）排他锁 X锁(exclusive)：事务可读可写。事务对数据A上了X锁，那么不允许其他事务加X锁或S锁。

2、三级锁协议

一级封锁协议：加X锁，事务结束释放X锁，保证不丢失修改情况，不能保证可重复读和不读脏数据。

二级封锁协议：一级基础上加S锁，读完操作结束即释放S锁，保证不丢失修改情况，能避免读脏数据，不能保证可重复读。

三级封锁协议：一级基础上加S锁，事务结束以后才释放S锁，可以防止丢失修改，读脏数据，重复读问题。

- 主要区别：什么时候操作需要申请加锁和释放锁时间。
- 不同的封锁协议使事务达到的一致性级别不同：封锁协议级别越高，一致性程度越高。