### 什么是三级封锁协议？

两种自己可以加的锁：排它锁以及共享锁

排它锁（Exclusive Lock）/X锁：事务对数据加上X锁，则只允许当前事务读取和修改数据，其它事务不能对该数据加上任何锁。
共享锁（Shared Lock）/S锁：事务对数据加S锁，当前事务可以读取数据而不能修改数据，其它事务可以同时对该数据加S锁，不能加X锁。

三级封锁协议

- 一级封锁协议：事务在修改数据之前必须对数据加X锁，事务结束后释放。由于两个事务不能同时对数据加X锁，因此避免了修改被覆盖，可以解决丢失修改问题。

- 二级封锁协议：在一级封锁协议基础上，事务在读取数据之前必须对数据加S锁，读取结束后释放。可以避免脏读问题。如果当前数据正在被修改，那么根据一级封锁协议，意味着有事务对该数据添加了X锁，则当前事务无法添加S锁，可以避免读取脏数据。

- 三级封锁协议：在二级封锁协议基础上，事务在读取数据之前必须对数据加S锁，事务结束后释放。根据共享锁的定义，若事务已经成功添加S锁，那么在它结束之前都不会有其它事务能够给该数据添加X锁修改，相比于二级封锁协议，可以避免读取结束后其它事务修改数据，造成不可重复读的问题。
