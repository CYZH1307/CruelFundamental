# RDB和AOF区别

RDB：

- redis某一时刻快照数据库持久化

- redis数据持久化的过程，将数据写入文件，持久化结束后，替换上次持久化文件。
- RDB方式，单独创建一个子进程持久化，主进程不会进行持久化。
- 大规模数据恢复，RDB方式比AOF更加高效。
- 缺点：RDB如果频繁持久化，当redis故障，就会有短时间数据丢失。

AOF：

- 只追加不该写
- 记录写指令，恢复按照指令执行一遍
- redis.conf中appendonly yes开启AOF，如果有写操作，会追加到AOF文件末尾。
- 默认的AOF持久化策略每秒fsync一次，这种情况redis仍然可以很好处理
- 追加日志的时候，磁盘满，断电等，reids可以redis-check-aof修复日志。
- 追加方式，不做处理，AOF文件会越来越大，当大小超过阈值，会开始内容压缩。将类似的指令进行合并。AOF重写的时候，采用先写临时文件，全部完成以后再替换的流程。
- AOF缺点，同样数据规模，AOF比RDB文件体积大，恢复速度慢。