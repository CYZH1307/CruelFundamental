# C++: 什么是智能指针？智能指针有什么用？分为哪几种？各自有什么特点？

智能指针是`cpp` STL提供的模板类, 其是`RAII`编程思想的具体实现之一。
具体而言, 智能指针类在初始化时管理用户指定的资源(通过指针), 在析构的时候检查引用计数是否为0, 从而选择是否释放资源。即其可以安全的管理用户指定的资源, 思路是记录**引用计数**, 需要注意的是, 该引用计数**必须通过指针**的方式(网上很多博客写的值类型应该是错的), 且底层数据应该是`atomic`类型的, 保证多线程的并发安全性。

`cpp11`提供的智能指针分为三种:
- shared_ptr: 共享智能指针
- weak_ptr: 弱智能指针, 与`shared_ptr`关联后, 可通过`lock()`成员函数获取一个`shared_ptr`对象, 注意需要判断.(`lock() != nullptr`)
- unique_ptr: 独占指针.

`weak_ptr`的可以用来防止循环引用.

`shared_ptr`的实现中有一根指向`control block`的**指针**, 该`control block`中包含两个`atomic int`, 分别是`shared_ptr`、`weak_ptr`引用计数. 使用`shared_ptr`的时候需要注意指针资源只能构造一个`shared_ptr`对象, 否则多次构造会导致重复释放, 造成`core dump`.
