## HTTP/1.0，HTTP/1.1，HTTP/2，HTTP/3的区别
HTTP1.1在1.0的区别：
1. 使用长链接代替短链接，改善HTTP1.0的性能开销
2. 支持管道传输，只要第一个发出去了，就可以发第二个，减少整体的时间
HTTP1.1的瓶颈
1. 请求/响应头未经过压缩就发送，首部信息越多延迟越大，只能压缩body部分
2. 发送冗长的首部，每次互相发送首部造成较多的浪费
3. 服务器是按照请求的顺序发送的，如果服务器响应慢，会导致客户端一直收不到请求，也就是对头阻塞
4. 没有请求优先级
5. 请求只能从客户端开始，服务端只能被动

HTTP2.0的优化
1. 头部压缩，如果同时发送多个请求，他们的头部是一样的或者相似的，那么协议会帮你消除重复的部分，这就是所谓的`HPACK`算法，在客户端和服务端共同维护一张信息表，所有的字段都会存入这个表，生成一个索引号，以后就不用发送同样的字段了，只发送索引号，提高速度。
2. 二进制格式，头信息和body都是二进制，统称为帧，头信息帧，和数据帧，这样收到报文之后，省去了将明文转为二进制的时间，增加了数据传输的效率
3. 并发传输，同一个连接中，HTTP完成一个事物，才能完成下一个事物，也就是在发出请求等待的过程中，是没办法做其他事情的，后续也是无法发送的，会造成对头阻塞，HTTP引入了stream的概率，解决了头部阻塞，多个stream复用一个TCP连接。针对不同的HTTP请求用独一无二的streamID来区分，接收端可以通过ID有序的组装成HTTP消息，不同的stream的帧是可以乱序发送的，因此可以并发不同的stream，也就是HTTP/2可以并发的交错的发送请求和响应。但是在TCP端仍然是上限。
4. 服务端可以主动推送，双方都简历stream，分奇偶即可
缺陷：
1. 通过stream增加了并发能力，解决了HTTP/1.x的对头阻塞问题，但是还是存在，而是在TCP层，HTTP/2是基于TCP来传输的，TCP是字节流协议，TCP必须保证收到的字节数是完整连续的，这样内核才会把缓存区的数据返回个HTTP应用，那么当前一个字节数据没有到达后，后续收到的字节数据只能放到内核缓存区中，只有等到这一个到达之后，HTTP/2才会从内核中拿数据。一旦发生丢包，就会出发TCP重传机制，这样在一条TCP连接中的所有HTTP请求都必须等待这个丢的包回来。

HTTP3的优化
quic的特点：
1. 无队头阻塞，当某个流发生丢包的时候，只会阻塞住当前的流，其他不受影响，不存在对头阻塞
2. 更快的连接建立。HTTP2需要先TCP三次握手，在TLS四次握手，HTTP3只需要1RTT，是quic报文内部包含了TLS，他在自己的帧会携带TLS里的记录，再加上quic使用的是TLS/1.3，因此1RTT就可以。甚至在第二次连接的时候，只需要0RTT，第一个报文将quic连接信息和数据包一起发送。
3. 连接迁移，基于TCP的需要四元祖。当ip变了，就要断开重连。quic使用连接ID来标记通信的连个端点，只要上下文信息没变，就可以无缝复用原本的连接，消除重连的成本，达到连接迁徙
