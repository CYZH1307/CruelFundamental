### 进程、线程、协程的区别

#### 进程和线程区别：

1、进程可以看做是程序+数据集合+进程控制块组成。线程可以看做是进程当中的一条执行路径。一个进程可以由一个或者多个线程组成。**进程拥有完整的资源，线程只会独占必不可少的资源(栈+寄存器)**。同一个进程当中的多个线程可以共享进程的代码段、数据段、打开的资源，同时每个线程有自己的寄存器和栈，确保线程的控制流独立。

2、**线程可以减少并发执行的时间和空间开销**：

- 线程创建时间快，进程创建需要资源管理信息(内存,文件)，线程直接共享进程的资源。
- 线程终止速度比进程块，因为线程需要释放的(栈 寄存器)比进程少。
- 同一进程内的线程切换比进程之间切换速度快。
  - **线程共享进程的地址空间（虚拟内存共享），因此同一个进程的线程是使用同一个页表，在切换的时候不需要切换页表。**
  - 进程之间的切换，切换要将页表切换，开销较大。

- 同一进程内的线程，共享内存和文件资源，线程之间数据传递，不需要内核额外开销，数据交换快。

3、**进程是操作系统分配资源的最小单位，线程是cpu调度的最小单位。**操作系统调度的对象是线程，进程为线程提供共享的虚拟内存、全局变量。进程和线程的关系：

- 进程只有一个线程，可以认为进程就是线程。
- 进程有多个线程，线程会共享虚拟内存和全局变量等资源，同一进程内的共享资源上下文切换不需要修改，但是线程独占资源，寄存器和栈，上下文切换需要保存。

- 线程上下文切换，如果两个线程不是同一个线程，等同于进程上下文切换。两个线程属于同一个进程，虚拟内存共享，共享资源不懂，切换线程私有的栈和寄存器数据。
- 线程分为用户线程、内核线程、轻量级线程。用户线程有TCP线程控制块，进程有自己私有的TCP列表来跟踪线程状态(PC、栈、寄存器)。内核线程由操作系统管理，TCP在操作系统当中。
- 当进程中的一个线程崩溃的时候，其所属的进程所有线程崩溃。用户线程，是由用户线程库调度，当一个线程发起系统调用阻塞，该线程所在进程的用户线程也会被阻塞。



#### 协程

协程：用户态的轻量级线程。协程的调度是通过用户自己控制的，有自己的寄存器和栈。协程调度的时候不需要操作系统内核直接参与，协程切换不涉及系统调用和阻塞调用，协程可以配合异步IO使用，在用户层进行并发（yield）。

协程没有增加线程数量，是在线程的基础上，分时复用的方式运行多个协程。一个线程可以运行多个协程。