

### 数据库主主、主从、主备的区别

![image-20220430201624354](firee.assets/image-20220430201624354.png)

![image-20220430202016603](firee.assets/image-20220430202016603.png)

![image-20220430202038936](firee.assets/image-20220430202038936.png)

ref:

mit6.824p1:https://www.bilibili.com/video/BV1qk4y197bB?p=1



对于一个分布式服务器，怎么去设计他的架构有几个共有的问题需要考虑

#### 1.performence

这里考虑更多的是scalability，即扩大服务器规模能够等比扩大吞吐量

#### 2.fault tolerance

系统的容灾能力，最好有服务器挂了也没事

#### 3.consistency

一致性问题，就是怎么去保证数据的同步



这三者是不能得兼的(也可能可以，不太确定)，所以要根据不同的应用场景，用不同的架构

这里假设主备，主从，主主都是最简单的那种结构，

那么

主备:显然满足fault tolerance，由于只有一个主机与外界交互，所以也天然满足consistency

主从:主要目的是performence，如果只有数据读取，那三者兼得，如果有数据写入，consistency和performance只可得一，(两种实现方式，一是在服务器前加入一个分发的中间件，要等所有写操作结束后才能进行读操作，这样会让这个木桶再填上一块短板(中间件),同时写操作时不满足performance，适用于大量读的场景，二是顺其自然，你读你的，我写我的，不满足consistency，可能会适用于那种检测场景，比如想查现在的气温，结果查到的是五分钟前的，似乎也无伤大雅)

主主:与主从的区别只有他希望对写操作也能满足performance，这个其实应用场景比较少，因为他不可能在满足performance的前提下满足consistency，其实就是每个服务器各写各的，各读各的，时不时同步一下，感觉天气预报好像就是这么个场景



