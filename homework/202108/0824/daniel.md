## 逃逸分析

内存通过垃圾回收机制自动管理的语言, 需要有逃逸分析来决定变量分配的位置( 堆, 或者栈上)

逃逸分析由编译器负责, 作用域编译阶段

## 几种类型

- 指针逃逸
    - 返回了局部变量对象的指针, 函数退出后, 还需要访问变量, 因为要分配在堆上
- golang interfac{} 类型
    - 由于编译期间决定不了具体的类型, 也会发生逃逸, 将对象分配在堆上
- 栈空间不足
    - 栈空间通常有限制, 例如8M, 如果局部变量超过了此限制, 就会发生逃逸, 被分配在堆上
- 闭包
    - 闭包外层函数的变量在函数退出后, 都要被内层函数访问到, 所以也需要分配在堆上

## 优劣

- 逃逸可以避免 copy
- 但是分配到堆上会增加 GC 负担, 合理选择.