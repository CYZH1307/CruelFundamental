## 什么是 lamport logical clock


分布式系统解决了传统单体交媾的单点问题和性能容量问题，另一方面也带来了很多问题，其中之一就是多节点的时间同步问题。

逻辑时钟指的是分布式系统中用于区分时间发生顺序的时间机制

为什么需要逻辑时钟？

单个计算机执行的事务，由于共享计时器，因此容易通过时间戳区分先后关系。

在分布式系统中，定义两个事件可以建立因果（时序）关系的前提是，两个时间之间是否发生过信息传递。

分布是系统，进程间通信的手段（共享内存，消息发送等）都属于信息传递，如果两个进程间没有任何交互，实际上内部的时序也不重要。但是有交互的情况下，时间时序很重要。


分布式系统按是否存在节点交互可分为三类时间，一类发生在节点内部，二是发送事件，三是接受事件。

1. 每个事件对应一个lamport时间戳，初始为0
2. 如果事件在节点内发生，本进程的时间戳+1,
3. 如果事件属于发送事件，那么本进程的时间戳+1，并且在消息中带上该时间戳。
4. 如果事件属于接受时间，本进程时间戳=max（本地时间戳， 消息时间戳） + 1

lamport时钟只保证因果关系的偏序正确性，不保证绝对时序的正确性。

lamport时钟是一个正确的算法，有因果关系的时间时序不会错，而并不是公平算法，因为没有因果关系的时序不一定符合情·

