### 外中断和异常有什么区别
异常和中断是意外事件，它们会破坏指令的正常执行流程（当前由处理器执行）。异常是来自处理器内部的意外事件。中断是来自进程外部的意外事件。

每当发生异常或中断时，硬件就会开始执行代码，以执行响应异常的操作。此操作可能涉及终止进程、输出错误消息、与外部设备通信，或通过启动“蓝屏死机”并停止 CPU 来使整个计算机系统严重崩溃。负责此操作的指令驻留在操作系统内核中，执行此操作的代码称为中断处理程序代码。现在，我们可以将处理程序代码视为操作系统子程序。然后，在处理程序代码执行后，可能会在发生执行或中断的指令之后继续执行。

异常和中断处理：
每当发生异常或中断时，执行从用户模式转换到处理异常或中断的内核模式。具体来说，必须采取以下步骤来处理异常或中断。

在进入内核时，必须首先将当前执行进程的上下文（所有 CPU 寄存器的值）保存到内存中。内核现在已准备好处理异常/中断。

确定异常/中断的原因。
处理异常/中断。
处理异常/中断后，内核将执行以下步骤：

选择要恢复和恢复的进程。
恢复所选进程的上下文。
恢复执行所选进程。
在任何时间点，CPU 中所有寄存器的值都定义了 CPU 的上下文。 CPU 上下文的另一个名称是 CPU 状态。

异常/中断处理程序使用与当前执行进程相同的 CPU。进入异常/中断处理程序时，异常/中断处理程序使用的所有 CPU 寄存器中的值必须保存到内存中。保存的寄存器值可以稍后在恢复执行过程之前恢复。

可能出于多种原因调用了处理程序。因此，处理程序需要确定异常或中断的原因。有关导致异常或中断的原因的信息可以存储在专用寄存器或内存中的预定义地址中。

接下来，需要处理异常或中断。例如，如果是键盘中断，则获取按键的键码并将其存储在某处或采取一些其他适当的动作。如果是算术溢出异常，则可能会打印错误消息或终止程序。

现在已经处理了异常/中断和内核。内核可以选择恢复在处理异常/中断之前正在执行的同一进程，或者恢复当前在内存中的任何其他进程的执行。

现在可以通过从内存中读取和恢复所有寄存器值来恢复所选进程的 CPU 上下文。

选择要恢复的进程必须在它停止的同一点恢复。这条指令的地址是在中断发生时被机器保存下来的，所以只要拿到这个地址，让CPU继续在这个地址上执行就行了。

参考：https://www.geeksforgeeks.org/interrupts-and-exceptions/#:~:text=An%20exception%20is%20an%20unexpected,in%20response%20to%20the%20exception.