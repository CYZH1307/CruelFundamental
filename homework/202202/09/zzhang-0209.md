如何保证缓存一致性？



缓存一致性问题：

- 线程更新数据库后再更新缓存
- 若两个线程同时更新，则缓存中的值可能和数据库中的不一样

解决方案1 - 分布式锁

- 利用分布式锁把缓存操作和数据库操作装为逻辑上的一个操作
  - 如果要更新数据，先申请分布式锁
  - 成功获得锁则更新缓存和数据库中的值
  - 不成功则abort

解决方案2 - 删除缓存

- 以数据库中的数据为主，在更新完数据库中数据后删除缓存，下一次读的时候在读入缓存中。

