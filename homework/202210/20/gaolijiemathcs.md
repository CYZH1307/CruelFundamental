### 如何将公钥从证书中取出？如何验证证书合法?

客户端拿到服务端的数字证书后需要校验数字证书的有效性，并将公钥从CA证书中取出。

数字证书包含了：公钥、持有者信息、证书认证机构（CA）信息、CA对这份文件的数字签名以及使用的算法、证书的有效期、其他额外信息。

CA签发证书的过程：

- 首先CA会将持有者的公钥、用户、颁发者、有效期等信息打成一个包，然后对这些信息进行Hash计算，得到Hash值。
- CA会使用自己的私钥将该Hash值加密，生成Certificate Signature，CA对证书做了签名
- 最后将Certificate Signature添加到文件整数上，形成数字证书。

客户端校验服务端的数字证书的过程：

- 客户端使用同样的Hash算法获取该证书的Hash值H1
- 浏览器和操作系统集成了CA的公钥信息，浏览器收到证书后使用CA的公钥解密Certificate Signature内容，得到一个Hash值H2
- 最后比较H1和H2，如果相同，则为可信赖的证书，否则认为证书不可信。



