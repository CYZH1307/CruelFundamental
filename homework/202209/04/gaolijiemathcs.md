### 什么是跨域资源请求？如何解决？

#### 什么是跨域资源请求？

定义：url由协议、域名、端口三部分组成，当一个请求的url的协议、域名、端口三者之间的任意一个与当前页码url不同即为跨域。三者都相同属于同源。

出现跨域请求原因：浏览器的`同源策略`限制。同源策略（Same Orgin Policy）是一种约定，它是浏览器核心也最基本的安全功能，它会阻止一个域的js脚本和另外一个域的内容进行交互，如果缺少了同源策略，浏览器很容易受到XSS、CSFR等攻击。

跨域出现的限制：

- 无法读取非同源网页的cookie、localstorage等
- 无法接触非同源网页的DOM和js对象
- 无法向非同源地址发送Ajax请求

#### 如何解决？

1、nginx反向代理解决跨域（前端常用）

```
正向代理：
a-->b访问不了，可以找个中间的服务器c, 先访问c再从c到b,类似曲线救国。
明确访问的目的地，但是用户不知道中间的代理服务器。（忽略中间服务器）。
反向代理：a--> c <--b
a明确访问c代理服务器，但是不知道c的内容从哪里来，c反向从别的地方拿来数据。(忽略的是目标地址)
```

浏览器可以访问a,而服务器之间不存在跨域问题，浏览器先访问a的服务器c，让c服务器作为代理去访问b服务器,拿到之后再返回数据给a。

2、添加响应头解决跨域

浏览器先询问b,b允许a访问
access-control-allow-origin
access-control-max-age
PHP端修改header：

```awk
header('Access-Control-Allow-Origin:*');//允许所有来源访问
header('Access-Control-Allow-Method:POST,GET');//允许访问的方式
```

3、通过jsonp解决跨域（老方法）

`实现原理：`通常为了减轻web服务器的负载，我们把js、css、图片等静态资源分离到另一台独立域名的服务器上，在html页面中再通过相应的标签从不同域名下加载静态资源，而被浏览器允许。

```
html中有的标签天然支持跨域，比如<script src="http://www.baidu.com"></script>但是只支持get请求。
```

4、CORS解决跨域(`第三方模块`)

它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。





ref:https://segmentfault.com/a/1190000040485198