# CruelFundamental 20210916 - gRPC 为何使用 HTTP2 传输数据
- https://zhuanlan.zhihu.com/p/161577635

## HTTP1.1 的缺点
- 无状态，每次请求带有重复冗余的Header
- 协议基于文本，请求封装在头部或报文，通过换行符分割
- 同一个TCP连接，无法区分请求回复属于哪次访问
- 顺序等待，无法并发
- 虽有Pipeline功能，但是对服务器有要求，对代理不友好
- 创建多个连接下载资源，客户端资源消耗大
- Chrome对同一域名并发连接数限制为6，其他会等待
- HTTP2支持并发，无需等待

## HTTP2 原理
- HTTP2 没有改变动作的语义，只是优化了传输
- 引入流 Stream 和帧 Frame 的概念，同一连接可以区分多个请求回复
- 一个域名只有一个连接，多路复用，降低资源消耗
- 二进制编码可以压缩头部，HPACK，比如3表示POST

## HTTP2 流
- 同一连接，每次请求为一个流，ID唯一
- 一个请求分成多个帧，帧按流ID进行分组，分离出不同的请求
- 不同流的不同帧可以穿插
- 所有数据交互为帧为单位，比如Header，Body

## gRPC
- 请求方法只发送一次
- 服务器头部回复只返回一次
- 客户端的数据帧和服务器端的数据组交互
- 只有一次请求，流ID不变
