## 描述一下JVM加载class文件的原理机制

类加载子系统负责从文件系统或者网络中加载class文件，class文件在文件开头有特定的文件标识。

类加载过程包括：加载阶段、链接阶段(验证、准备、解析)和初始化阶段

类加载过程：

### 加载阶段

这里的"加载"是"类加载"的一个阶段。

通过一个类的全限定名称获取该类的二进制字节流。

将二进制字节流代表的静态结构转化为方法区的运行时数据结构。

在内存中创建一个代表该类的java.lang.Class对象，作为方法区这个类的各种数据访问入口。

### 链接阶段

（1）验证：

验证阶段确保Class文件的字节流中包含的信息符号当前虚拟机的要求，不会危害虚拟机自身安全。

- 文件格式验证：字节流是否符合Class文件格式规范，并且版本可以被虚拟机处理。例如是否以魔数开头、版本号验证、常量池常量类型检查等等。
- 元数据验证：字节码描信息进行语义分析，确保符合Java语法规范。
- 字节码验证：对方法体进行语义分析。
- 符号引用验证：确保解析正常执行

（2）准备：为类变量分配内存并且设置该类变量的默认初始值，零值。

（3）解析：将符号引用转换为直接引用。

### 初始化阶段

对静态变量和静态代码块执行初始化工作。

