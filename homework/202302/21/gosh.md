Redis 如何实现服务高可用？

单点部署Redis服务，一旦宕机就不可用了。
通常的做法：将数据库复制多个副本以部署在不同的服务器上，其中一台挂了也可以继续提供服务。

Redis 实现高可用有三种部署模式：主从模式，哨兵模式，集群模式

主从模式：Redis部署了多台机器，有主节点负责读写操作，从节点只负责读操作。从节点的数据来自主节点。

哨兵模式：
主从模式中 一旦主节点由于故障不能提供服务，需要将从节点晋升为主节点 并且通知应用方更新主节点地址。
用哨兵架构来解决这个问题
由（多个）哨兵进程对Redis节点进行监控。当主节点进入下限状态时，自动将其某个从节点升级为新的主节点。


发送命令，等待Redis（主和从）服务器返回 监控运行状态
监测到主节点宕机，自动将从节点切换成主节点，然后通知其他从节点，修改配置文件，让他们切换主机
哨兵之间相互监控

集群模式：
以上实现读写分离，可以自动切换
但是每个节点存储的数据是一样的，浪费内存且不好在线扩容

因此使用 Cluster集群

实现了Redis的分布式存储

集群节点的通讯：Gossip协议
节点之间不断交换信息，包括节点出现故障，新节点加入，主从节点变更信息，slot信息等等
常用的4种Gossip信息：
meet
通知新节点加入
消息发送者通知接收者加入到当前集群
meet消息通信正常完成后，接受节点加入集群中，并进行周期性的ping, pong消息交换

ping
集群内每个节点每秒向多个其他节点发送ping消息，用于检测节点是否在线和交换彼此状态信息。

pong
接收到ping\meet消息时，作为响应消息回复给发送方确认消息正常通信。
封装了自身状态数据
也可以向集群内广播自身的pong消息来通知整个集群对自身状态进行更新

fail
当节点判定集群内另一个节点下线时，会向集群内广播一个fail消息
其他节点接收到fail消息之后把对应节点更新为下线状态

使用Hash Slot插槽算法
