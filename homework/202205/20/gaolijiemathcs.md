### 简述TCP协议的滑动窗口，TCP协议的拥塞控制，快重传机制。

#### 滑动窗口

TCP的滑动窗口机制要维护接收窗口、拥塞窗口，来使用窗口机制实现流量控制。

（1）接收窗口rwnd

接收方根据目前接收方缓存大小允许的最新窗口值，反映接收方的容量，由接收方根据其放在TCP报文首部的窗口字段通知发送方。

（2）拥塞窗口cwnd

发送方根据自己估算的网络拥塞程度设置的窗口值，反映网络当前容量。依据的是拥塞控制和重传机制。

最终发送窗口取接收窗口和红色窗口的最小值。

```
发送窗口的上限值=min[rwnd,cwnd]
```



#### TCP拥塞控制

拥塞控制，防止过多的数据注入网络，保证网络中的路由器或者链路不过载。主要维护的是拥塞窗口：

（1）慢开始算法：从cwnd=1开始（发送一个最大报文段长度MSS），收到一个新的新报文段的确认后将cwnd+1，这样每一轮次表现出来就是每一轮对cwnd进行加倍。直到cwnd到达最开始设定的ssthresh开始拥塞避免。

（2）拥塞避免：经过一个往返时延RTT就增加一个MSS大小，不是加倍，cwnd按照线性增长，当出现超时的时候进行拥塞避免，将ssthresh设置为当前发送方cwnd值的一半，将拥塞窗口cwnd重新设置为1，执行慢开始算法。方便将减少主机发送的网络分组数，使得发送拥塞的路由器有足够的时间将队列中积压的分组处理完。



TCP快重传机制

快重传和快恢复，为慢开始和拥塞避免算法的改进。

（1）快重传：用冗余重复确认ACK检测丢包，当发送方连续收到3个重复ACK报文，直接重传对方未收到的报文段不需要等待该报文段设置的重传计时器超时。触发快恢复。

（2）快恢复：发送端收到3个冗余ACK，将慢开始门限ssthresh设置为拥塞时发送方cwnd的一半，不同于拥塞避免，cwnd值设置为慢开始门限ssthresh改变后的数值。直接开始执行拥塞避免算法，按照线性增长。跳过了从1开始慢开始过程，称为快恢复。



