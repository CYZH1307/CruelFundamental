## Redis 如何实现延迟队列？

1. Sorted Set（有序集合）：在有序集合中，将每个任务存储为一个元素，将任务的执行时间作为分数，按分数排序。可以使用Redis提供的ZADD命令添加任务到有序集合中，使用ZRANGE命令获取到期的任务。

2. List（列表）+Lua脚本：使用列表存储任务，列表的头部为最近加入的任务。可以使用Redis提供的LPUSH命令将任务添加到列表头部，使用Lua脚本实现获取到期的任务并删除。这种方式可以减少网络传输次数，但需要编写Lua脚本。

3. Stream（流）：Redis 5.0引入了Stream数据结构，可以用于实现消息队列和延迟队列。使用XADD命令将任务添加到Stream中，并指定到期时间作为一个字段。使用XREAD命令获取到期的任务。这种方式可以支持多个消费者，并且不会漏掉任务。

4. Redisson框架：Redisson是一个基于Redis实现的Java框架，提供了一系列分布式对象和服务，包括延迟队列。可以使用Redisson提供的RDelayedQueue对象实现延迟队列，将任务添加到延迟队列时指定延迟时间，Redisson内部使用Redis的Sorted Set实现。
